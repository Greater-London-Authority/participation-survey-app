---
title:  "<br> London Labour Market Update"
date: "[Matthew Tibbles](mailto:matthew.tibbles@london.gov.uk), `r format(Sys.Date(),'%B %Y')`"
runtime: shiny
output:
  html_document:

    css:  !expr "here::here('FORMATTING','GLAstyle.css')"
    includes:
      in_header: !expr "here::here('FORMATTING','favicon.html')"
      before_body: !expr "here::here('FORMATTING','header.html')"
      after_body: !expr "here::here('FORMATTING','footer.html')"
editor_options: 
  markdown: 
    wrap: 78
---

```{r setup, include=FALSE}
  
  knitr::opts_chunk$set(echo = TRUE,scipen=999)
  knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
  options("scipen"=100, "digits"=4)
  


  
```

```{r, include=F}
library(here)
library(shinyglide)
library(shinyjs)
library(bslib)
library(shinyWidgets)
source(here('scripts/master.R'))



# art_proxy_list <- lapply(
#   art_choices, function(q) {
#     #print(q)
#     generate_regional_proxy(
#       SURVEY_PATH, RELEASE_YEAR,
#       list('code'=REGION_QUESTION_LIST[[1]][q],'theme'=REGION_QUESTION_LIST[[2]][q], 'color'=REGION_QUESTION_LIST[[3]][q])
#     )
#   }
# )





```


<hr  width="100%" style="background-color: rgb(134,139,142);height: 1.0px;margin: 0;"/>

<!-- Summary of findings - MANUALLY ADJUST -->

<br/>

::: {.quotebox .quote_symbol}
Insert <br><br> Some text <br><br> about the <br><br> participation survey <br><br>
:::

<hr  width="100%" style="background-color: rgb(134,139,142);height: 1.0px;margin: 0;"/>

<br/>

## Arts

```{r, echo=F}
# Arts UI
fluidPage(
  useShinyjs(rmd=T),
  div(class='section-ui',
    shinyjs::hidden(
      pickerInput(
        inputId="arts_select",
        label="Question",
        choices = ARTS_QUESTIONS,
        selected=1,
        multiple=F
      )
    ),
    highchartOutput('arts_plot', height='75vh'),
    fluidRow(
      column(3),
      column(2, uiOutput("arts_previous_btn")),
      column(5),
      column(2, uiOutput("arts_next_btn"))
      
    )
  )
)

```

```{r, context="server", echo=F}
# Arts server
# output$arts_select_btn <- renderUI({
#   selectInput(
#     inputId="arts_select",
#     label="Question",
#     choices = ARTS_QUESTIONS,
#     selected=1,
#     multiple=F,
#     selectize=T
#   )
# })
  useShinyjs()
output$arts_previous_btn <- renderUI({
  actionButton(
    "arts_previous", 
    "Previous",
    icon=icon("backward")
  )
})
output$arts_next_btn <- renderUI({
  actionButton(
    "arts_next", 
    "Next",
    icon=icon("forward")
  )
})
# output$selected <- renderText({
#   paste0('You have selected ', input$arts_select)
# })
output$arts_plot <- renderHighchart({
  generate_drilldown_plot(input$arts_select, df_list)
})
observeEvent(input$arts_previous, {
  current <- which(ARTS_QUESTIONS == input$arts_select)
  if(current > 1) {
    updateSelectInput(
      session, "arts_select",
      selected = ARTS_QUESTIONS[current - 1]
    )
    update_drilldown_plot(input$arts_select, df_list, "arts_plot")
  }
  }, ignoreInit=T
  )
# 
observeEvent(input$arts_next, {
  current <- which(ARTS_QUESTIONS == input$arts_select)
  if(current < length(ARTS_QUESTIONS)){
    updateSelectInput(
      session, "arts_select",
      selected = ARTS_QUESTIONS[current + 1]
    )
    update_drilldown_plot(input$arts_select, df_list, "arts_plot")
  }
  }, ignoreInit=T
  )
```

<br/> <br/> <a href="#top">Back to top</a>

<hr  width="100%" style="background-color: rgb(134,139,142);height: 1.0px;margin: 0;"/>

<br/>

## Libraries

```{r, echo=F}
# Arts UI
#fluidRow(
  #highchartOutput('art_plot', height='65vh'),
  shinyjs::hidden(div(id='libraries_selector', uiOutput("libraries_select_btn")))#,
  #textOutput('selected')
  highchartOutput('libraries_plot', height='75vh', width='53vw')
  uiOutput("libraries_previous_btn")#,
  uiOutput("libraries_next_btn")
#)

```

```{r, context="server", echo=F}
# libraries server
output$libraries_select_btn <- renderUI({
  selectInput(
    inputId="libraries_select",
    label="Question",
    choices = LIBRARIES_QUESTIONS,
    selected=1,
    multiple=F,
    selectize=T
  )
})
output$libraries_previous_btn <- renderUI({
  actionButton(
    "libraries_previous", 
    label = "Previous"
  )
})
output$libraries_next_btn <- renderUI({
  actionButton(
    "libraries_next", 
    label = "Next"
  )
})
# output$selected <- renderText({
#   paste0('You have selected ', input$libraries_select)
# })

output$libraries_plot <- renderHighchart({
  generate_drilldown_plot(input$libraries_select, df_list)
})

observeEvent(input$libraries_previous, {
  current <- which(LIBRARIES_QUESTIONS == input$libraries_select)
  if(current > 1) {
    updateSelectInput(
      session, "libraries_select",
      selected = LIBRARIES_QUESTIONS[current - 1]
    )
  update_drilldown_plot(input$arts_select, df_list, "libraries_plot")
  }
  }, ignoreInit=T
  )
# 
observeEvent(input$libraries_next, {
  current <- which(LIBRARIES_QUESTIONS == input$arts_select)
  if(current < length(LIBRARIES_QUESTIONS)){
    updateSelectInput(
      session, "libraries_select",
      selected = LIBRARIES_QUESTIONS[current + 1]
    )
    update_drilldown_plot(input$arts_select, df_list, "libraries_plot")
  }
  }, ignoreInit=T
  )
```

<br/> <br/> <a href="#top">Back to top</a>

<hr  width="100%" style="background-color: rgb(134,139,142);height: 1.0px;margin: 0;"/>

<br/>

## Libraries

**blah blah blah**

<br/> <br/> <a href="#top">Back to top</a>

<hr  width="100%" style="background-color: rgb(134,139,142);height: 1.0px;margin: 0;"/>

<br/>

## Libraries

**blah blah blah**

<br/> <br/> <a href="#top">Back to top</a>

<hr  width="100%" style="background-color: rgb(134,139,142);height: 1.0px;margin: 0;"/>

<br/>

## Libraries

**blah blah blah**

<br/> <br/> <a href="#top">Back to top</a>

<hr  width="100%" style="background-color: rgb(134,139,142);height: 1.0px;margin: 0;"/>

<br/>

## Libraries

**blah blah blah**

The ONS has published its latest [labour market update](https://www.ons.gov.uk/employmentandlabourmarket/peopleinwork/employmentandemployeetypes) covering Labour Force Survey (LFS) data for the three months ending and real-time information (RTI) data up to This bulletin presents the latest headline labour market estimates for London.

Please note:

-   Many of the statistics presented here are estimates based on surveys, and as such have a margin of error -- known as sampling variability.

-   They also cover different reference periods or count dates.

More information and previous GLA Economics analyses can be found on our labour market analysis [page](https://data.london.gov.uk/dataset/gla-economics-covid-19-labour-market-analysis).

More information on the data used and a glossary of terms can be found on the [ONS website](https://www.ons.gov.uk/employmentandlabourmarket/peopleinwork/employmentandemployeetypes/methodologies/aguidetolabourmarketstatistics).

<a href="#top">Back to top</a>

</font>


